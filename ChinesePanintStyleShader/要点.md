
![[Pasted image 20230923161556.png]]

水墨风总体与卡通渲染比较相似，可以分为两部分，内部和描边。

## 内部

按顺序来实现：颜色分层，墨水扩散，纸浸模糊

### 颜色分层

亮暗分层明显，在卡通渲染中一个模型往往有亮部颜色和暗部颜色，且需要一个截断系数来判断。而在这里由于颜色比较单一，可以用ramp贴图来作为BaseColor，从而形成颜色分层。简单的halfLambert系数就可以用来采样这个贴图。注意把Ramp贴图的warp mode设置为clamp。
![[Pasted image 20230923170103.png]]
![[Pasted image 20230923162918.png]]
![[Pasted image 20230923162930.png]]
![[Pasted image 20230923162943.png]]


### 墨水扩散

![[Pasted image 20230923163025.png]]
外观上可以看作把颜色分界线变软了，或者说变得圆润了一些，更有笔触的感觉。

如果想要局部的去影响这种边界还挺麻烦的，一种比较简单的方法是用一张笔触纹理：

![[Pasted image 20230923164043.png]]

用模型UV采样这个笔触直接作为颜色输出：

![[Pasted image 20230923164919.png]]

已经有内味儿了，注意上面这种笔触纹理一般对应模型的中间部分。

让笔触颜色和基础色相乘，做一次正片叠底，下图可以看到整体变暗且有一些笔触扩散的效果了：

![[Pasted image 20230923165313.png]]

因为正片叠底（颜色相乘）会让颜色越来越暗，那么设置Ramp颜色就越来越没意义，所以需要把整体思路给拉回来，不直接做颜色相乘，而是不断影响采样ramp的值。

将采样到的笔触颜色附加在halflambert上，作为ramp采样的偏移值，因为事先把ramp给设置成了clamp，所以unity会自动帮我们截断uv。

![[Pasted image 20230923174715.png]]

为了让水墨效果更侵染一点，可以用一张噪声图来影响笔触颜色对于偏移的大小，同时声明一个变量来控制噪声的作用，由于正片叠底的效果，_ InteriorNoiseLevel越大，笔触颜色带来的偏移值就会越小，整体就会越暗（ramp 0 黑 1 白）（例如外围的白色也会开始被侵染变暗）：
![[Pasted image 20230923175228.png]]
![[Pasted image 20230923180151.png]]
![[Pasted image 20230923180437.png]]
_ InteriorNoiseLevel等于1
![[Pasted image 20230923180250.png]]

另一种方式是直接加上InteriorNoise，效果也还行，而且不会让场景变暗。
![[Pasted image 20230923180124.png]]
![[Pasted image 20230923180130.png]]



### 纸浸模糊

现在是这样：
![[Pasted image 20230923180638.png]]

正常应该是这样：
![[Pasted image 20230923180621.png]]

什么模糊都行，高斯模糊，双重模糊等等

![[Pasted image 20230923183442.png]]
![[Pasted image 20230923183544.png]]



## 描边

和卡通渲染的描边方式差不多，在buildin里面可以使用双Pass，也就是第一个pass正常渲染但Cull Back第二个Pass Cull Front写描边，这里用工具将平滑后的法线给存在了模型切线中：
![[Pasted image 20230926144934.png]]
![[Pasted image 20230926144941.png]]


为了让描边有笔刷的感觉，用一张噪声纹理来随机clip片元：

![[Pasted image 20230926145816.png]]

![[Pasted image 20230926150020.png]]